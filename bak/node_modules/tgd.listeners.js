/**
 * Gestion d'une liste de fonctions devant réagir à des événements.
 * @class
 */
var Listeners = function() {
    this._list = [];
};

/**
 * Ajouter un __listener__ à la liste.
 * @param listener{function} Fonction à appeler quand l'énément est déclenché.
 * @return false  si le __listener__  n'a pas été ajouté  (parce qu'il
 * existe déjà ou parce qu'il n'est pas une fonction).
 */
Listeners.prototype.add = function(listener) {
    if (typeof listener !== 'function') return false;
    this.remove(listener);
    for (var i = 0 ; i < this._list.length ; i++) {
        if (listener === this._list[i]) return false;
    }
    this._list.push(listener);
    return true;
};

/**
 * Supprimer le __listener__ de la liste.
 * @param listener{function} Fonction à appeler quand l'énément est déclenché.
 * @return false si le __listener__  n'existe pas.
 */
Listeners.prototype.remove = function(listener) {
    if (typeof listener !== 'function') return false;
    for (var i = 0 ; i < this._list.length ; i++) {
        if (listener === this._list[i]) {
            this._list.splice(i, 1);
        }
        return true;
    }
    return false;
};

/**
 * Supprimer tous les __listeners__ de la liste.
 */
Listeners.prototype.clear = function() {
    this._list = [];
};

/**
 * Emettre l'événement. Tous les __listeners__ seront appelé avec __obj__ en tant que `this`.
 */
Listeners.prototype.fire = function(obj, arg) {
    var i, listener;
    for (i = 0 ; i < this._list.length ; i++) {
        listener = this._list[i];
        if (false === listener.call(obj, arg)) return false;
    }    
    return true;
};


module.exports = Listeners;